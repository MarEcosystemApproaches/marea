---
title: "Understanding Data Classes in marea"
author: "Emily O'Grady"
date: '`r Sys.Date()`'
output: 
  rmarkdown::html_vignette:
    toc: true
    toc_depth: 2
    toc_float: true
    theme: cerulean
vignette: >
  %\VignetteIndexEntry{Classes and Data Structures in marea}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Understanding Data Classes in `marea`

## Introduction

The `marea` package is built around robust S3 class objects:  
- **ea_data** for time series/tabular data  
- **ea_st** for spatio-temporal or gridded data

This makes all `marea` datasets work the same – easy for plotting, inspecting, and analysis.

---

## What is a "Class" in `marea`?

An R "class" defines _how_ an object behaves.  
Classes allow `marea` to automatically:
- Store rich metadata with each dataset
- Print, summarize, or plot datasets using custom methods
- Guarantee consistent, predictable structures (for you and collaborators)

The two core classes are:
- `ea_data`: 1D/tabular/time series (e.g. abundances, environmental indices)
- `ea_st`: gridded or spatial/time-varying fields (e.g. maps of temperature)

---

## ea_data: Clean, Consistent Time Series

All tabular time-series data in `marea` use the `ea_data` class.

### Example: Load, Print, and Summarize

```{r}
library(marea)

# Load grey seal abundance data
data("grey_seals")

# Print object summary (metadata, structure, preview)
print(grey_seals)
```

**Example output:**  

--- Ecosystem Approach (EA) Data Object ---
Class:           ea_data 
Data Type:       Estimated abundance (number of seals, 1000s) 

Data preview:

A tibble: 6 × 4
year   low median  high
<dbl> <dbl>  <dbl> <dbl>
1  1960   ...   ...   ...
2  ...    ...   ...   ...

### Data summary

```{r}
summary(grey_seals)
```

---

## Plotting: One-line Visualization

Plotting works out-of-the-box and returns a `ggplot2` object:

```{r}
plot(grey_seals)
```

*Output:*
<img src="man/figures/plot_grey_Seals.png" width="70%" />

If columns like `"low"` and `"high"` exist, add ribbons easily:

```{r}
plot(grey_seals, style = "ribbon")
```

Other styles: `"default"`, `"plain"`, `"red_blue"`, etc.

---

## ea_st: Spatio-Temporal/Gridded Data

Spatial (or spatio-temporal) objects are stored as **ea_st**—an extension of the standard `sf` class.

### Example: Inspect a spatial object

```{r}
data("glorys_bottom_temperature")
print(glorys_bottom_temperature)
```

*Output includes metadata, spatial bounds, etc.*

### Plot

```{r}
plot(glorys_bottom_temperature)
```

Other options:
- `style = "contour"`   (contour lines)
- `style = "bubble"`    (bubbles by value)

---

## Interoperability: Converting from `pacea` and Other Packages

`marea` works great with external datasets such as those from `pacea` (Pacific ecosystem data).

If you have a `pacea` time-series (pacea-index or pacea-biomass):

```{r}
library(pacea)
data(npgo) # Example: North Pacific Gyre Oscillation
marea_npgo <- as_ea_data(npgo)
class(marea_npgo)
print(marea_npgo)
```

For spatial objects, use:

```{r}
# Example: Convert pacea spatial object

```

---

## Why Use These Classes?

Using robust S3 classes brings multiple benefits:
- All datasets behave the same way (easy to plot, inspect, or summarize)
- Metadata (units, region, source, etc.) always travel with the data
- You can use base R summary/print/plot methods or build your own analyses on top

---

## Learn More

- The main [README](../README.html) has a quick start
- See "Working with Environmental Data": `vignettes/environmental-data.Rmd`
- To list all built-in datasets and their metadata:

```{r}
marea_metadata()
```

---

## Citing `marea`

Please cite the package in your work. For citation text:

```{r}
citation("marea")
```

---

*This vignette was generated using the `marea` source code (2025-07-11).*

---
